% 文件: HMM_test.m
% 说明: 自动添加的注释占位，请根据需要补充。
% 生成: 2025-08-31 23:06
% 注释: 本文件头由脚本自动添加

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ①定义一个HMM并训练这个HMM。
% ②用一组观察值测试这个HMM，计算该组观察值域HMM的匹配度。
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% O：观察状态数
O = 3;  % 详解: 赋值：计算表达式并保存到 O
Q = 4;  % 详解: 赋值：计算表达式并保存到 Q
data=[1,2,3,1,2,2,1,2,3,1,2,3,1;  % 详解: 赋值：计算表达式并保存到 data
      1,2,3,1,2,2,1,2,3,1,2,3,1;  % 详解: 执行语句
      1,2,3,1,2,2,1,2,3,1,2,3,1;  % 详解: 执行语句
      1,2,3,1,2,2,1,2,3,1,2,3,1;  % 详解: 执行语句
      1,2,3,1,2,2,1,2,3,1,2,3,1;  % 详解: 执行语句
      1,2,3,1,2,2,1,2,3,1,2,3,1;  % 详解: 执行语句
      1,2,3,1,2,2,1,2,3,1,2,3,1;  % 详解: 执行语句
      1,2,3,1,2,2,1,2,3,1,2,3,1;  % 详解: 执行语句
      1,2,3,1,2,2,1,2,3,1,2,3,1;  % 详解: 执行语句
      1,2,3,1,2,2,1,2,3,1,2,3,1;]  % 详解: 执行语句
prior1 = normalise(rand(Q,1));  % 详解: 赋值：将 normalise(...) 的结果保存到 prior1
transmat1 = mk_stochastic(rand(Q,Q));  % 详解: 赋值：将 mk_stochastic(...) 的结果保存到 transmat1
obsmat1 = mk_stochastic(rand(Q,O));  % 详解: 赋值：将 mk_stochastic(...) 的结果保存到 obsmat1
[LL, prior2, transmat2, obsmat2] = dhmm_em(data, prior1, transmat1, obsmat1, 'max_iter', size(data,1));  % 详解: 获取向量/矩阵尺寸
LL  % 详解: 执行语句
prior2  % 详解: 执行语句
transmat2  % 详解: 执行语句
obsmat2  % 详解: 执行语句
data1=[1,2,3,1,2,2,1,2,3,1,2,3,1]  % 详解: 赋值：计算表达式并保存到 data1
loglik = dhmm_logprob(data1, prior2, transmat2, obsmat2)  % 详解: 赋值：将 dhmm_logprob(...) 的结果保存到 loglik
B = multinomial_prob(data1,obsmat2);  % 详解: 赋值：将 multinomial_prob(...) 的结果保存到 B
path = viterbi_path(prior2, transmat2, B)  % 详解: 赋值：将 viterbi_path(...) 的结果保存到 path
save('sa.mat');  % 详解: 调用函数：save('sa.mat')



