O = 4;
Q = 4;
y=[1.0000    0.2953    0.0151    0.0032    0.9939    0.3012    0.0146       0    0.9571    0.2879    0.0131    0.0037    0.9601    0.2883    0.0125    0.0027;
    1.0000    0.3009    0.0127    0.0015    0.9854    0.3027    0.0127         0    0.9397    0.2891    0.0121    0.0052    0.9881    0.2946    0.0126    0.0025;
    1.0000    0.2991    0.0114    0.0008    0.9626    0.2981    0.0128         0    0.9132    0.2892    0.0121    0.0041    0.9856    0.2954    0.0109    0.0026;
    1.0000    0.2876    0.0082    0.0007    0.9819    0.2680    0.0108         0    0.9149    0.2633    0.0135    0.0021    0.9000    0.2769    0.0124    0.0021;
    0.9970    0.2929    0.0111    0.0010    0.9994    0.2870    0.0107  0.0007    1.0000    0.2897    0.0111    0.0003    0.9649    0.2987    0.0114         0;
    0.9547    0.2868    0.0110    0.0030    0.9925    0.2901    0.0107    0.0011    1.0000    0.2897    0.0107    0.0002    0.9449    0.2949   0.0122         0;
    0.8678    0.2393    0.0129    0.0049    0.8546    0.2291    0.0143         0    1.0000    0.2244    0.0098    0.0002    0.8507    0.2438    0.0147    0.0014;
    0.8599    0.2372    0.0144    0.0040    0.9231    0.2373    0.0113    0.0004    1.0000    0.2357    0.0121         0    0.9373    0.2445   0.0141    0.0016;
    0.8658    0.2419    0.0142    0.0048    0.9259    0.2378    0.0128    0.0015    1.0000    0.2404    0.0131         0    0.8730    0.2429    0.0140    0.0042;
    0.8674    0.2354    0.0153         0    1.0000    0.2232    0.0098   0.0003    0.8728    0.2372    0.0143    0.0014    0.7866    0.2219  0.0152    0.0039;
    0.9097    0.2406    0.0120    0.0000    1.0000    0.2342    0.0119   0    0.9243    0.2393    0.0137    0.0014    0.8304    0.2333  0.0140    0.0030;
    0.9178    0.2399    0.0130    0.0013    1.0000    0.2390    0.0130 0    0.8821    0.2388    0.0135    0.0041    0.8848    0.2329  0.0145    0.0032;
%     1.0000    0.2391    0.0092         0    0.8974    0.2482    0.0139  0.0003    0.8278    0.2268    0.0157    0.0023    0.9483    0.2339 0.0083    0.0019;

%%%%%%%%%%%%ÍâÈ¦145
 0.1010    0.8809    0.1875    0.0054    0.1092    0.8737    0.1934  0    0.0986    0.9169    0.1742    0.0043    0.1028    1.0000  0.2087    0.0017;
    0.1028    0.9472    0.1901    0.0054    0.1112    0.9165    0.1995    0    0.1085    0.9617    0.1784    0.0038    0.1123    1.0000  0.2147    0.0008;
    0.1053    1.0000    0.1956    0.0061    0.1134    0.9577    0.2071    0    0.1119    0.9963    0.1848    0.0041    0.1187    0.9879     0.2166    0.0009;  
    0.1210    1.0000    0.2197         0    0.1123    0.9968    0.2017   0.0034    0.1171    0.9689    0.2189    0.0014    0.1184    0.9531    0.1950    0.0065;
   0.1224    0.9825    0.2194         0    0.1097    1.0000    0.1962  0.0047    0.1153    0.9765    0.2237    0.0017    0.1148    0.9959   0.2060    0.0061;
    0.1187    0.9857    0.2106         0    0.1091    0.9797    0.1877   0.0042    0.1142    0.9513    0.2147    0.0009    0.1077    1.0000   0.1985    0.0054 ;
0.1166    1.0000    0.2359         0    0.1081    0.9618    0.2232   0.0042    0.1121    0.9332    0.2409    0.0015    0.1122    0.9209  0.2114    0.0087;
    0.1227    1.0000    0.2424         0    0.1072    0.9846    0.2214    0.0060    0.1127    0.9503    0.2516    0.0020    0.1118    0.9827   0.2284    0.0085;
    0.1162    1.0000    0.2375         0    0.1074    0.9676    0.2128    0.0059    0.1131    0.9354    0.2432    0.0016    0.1054    0.9859     0.2236    0.0079 ;  
  0.1056    0.9808    0.2272    0.0081    0.1151    1.0000    0.2328  0    0.1077    0.9452    0.2215    0.0045    0.1220    0.9592    0.2391    0.0005;
    0.1078    0.9841    0.2279    0.0095    0.1208    1.0000    0.2354    0    0.1062    0.9670    0.2194    0.0065    0.1206    0.9978   0.2478    0.0013;
    0.1084    0.9760    0.2269    0.0094    0.1200    0.9952    0.2341    0    0.1089    0.9729    0.2163    0.0068    0.1221    1.0000   0.2445    0.0015;
%   0.1130    1.0000    0.2122    0.0066    0.1156    0.9439    0.2473  0.0032    0.1093    0.9889    0.2217    0.0099    0.1278    0.9680  0.2451         0;
    
%%%%%%%%%%%%%%%%%%%%%222¹ö¶¯
 0.5320    0.3942    1.0000         0    0.5183    0.4148    0.8978  0.0016    0.4626    0.4248    0.8969    0.0086    0.4509    0.5094  0.8087    0.0086;
     0.5122    0.3546    1.0000         0    0.4651    0.3839    0.9236  0.0108    0.4210    0.4241    0.9481    0.0083    0.4526    0.4960  0.8839    0.0009;
     0.4949    0.4222    1.0000         0    0.4292    0.3645    0.8898   0.0386    0.4150    0.4734    0.9172    0.0134    0.4573    0.4884   0.8876    0.0112;
  0.4855    0.5098    0.8917         0    0.4638    0.4288    0.9247   0.0172    0.5319    0.3963    1.0000    0.0015    0.5319    0.4330  0.9440    0.0042;
    0.4638    0.4661    0.8761         0    0.4464    0.4552    0.8791  0.0101    0.5059    0.3624    1.0000    0.0017    0.4725    0.3955   0.9243    0.0130;
    0.4436    0.4669    0.9206    0.0058    0.4539    0.4688    0.9233   0.0076    0.4884    0.4124    1.0000         0    0.4349    0.3819  0.8937    0.0360;
0.5146    0.4218    0.9885    0.0016    0.4811    0.4950    0.9732       0    0.4747    0.4353    0.9495    0.0174    0.5530    0.4039  1.0000    0.0015;
    0.5167    0.4150    0.9389         0    0.4695    0.4646    0.9336    0.0017    0.4554    0.4599    0.9032    0.0125    0.5192    0.3679   1.0000    0.0049;
    0.4898    0.4169    0.9904    0.0069    0.4557    0.4684    0.9834    0.0032    0.4668    0.4796    0.9474    0.0058    0.5013    0.4216  1.0000         0;
0.4869    0.3747    1.0000         0    0.4763    0.3780    0.8773    0.0010    0.4388    0.4513    0.9057    0.0002    0.4484    0.3985    0.8086    0.0140;
    0.5086    0.3918    1.0000         0    0.5002    0.3982    0.9035    0.0015    0.4510    0.4488    0.9097    0.0043    0.4459    0.4410    0.8598    0.0138;
    0.5172    0.3780    1.0000         0    0.4771    0.3943    0.9354    0.0104    0.4387    0.4541    0.9576    0.0062    0.4542    0.4735   0.8971    0.0085;
%     0.6330    0.5204    0.7480    0.0299    0.6022    0.5017    1.0000    0.0145    0.6029    0.5197    0.9245         0    0.6003    0.5043    0.9360    0.0273;
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%ÄÚÈ¦212
 0.3168    0.9845    0.5519         0    0.3045    1.0000    0.5460    0.0001    0.2827    0.8788    0.5613    0.0042    0.3380    0.9422    0.4611    0.0089;
    0.3230    1.0000    0.5671         0    0.3014    0.9660    0.5248    0.0037    0.2831    0.8734    0.5546    0.0045    0.3540    0.8980    0.4514    0.0073;
    0.3197    1.0000    0.5773         0    0.3037    0.9955    0.5613    0.0034    0.2937    0.8939    0.5748    0.0049    0.3488    0.9400    0.4822    0.0079;
  0.2980    1.0000    0.5246    0.0010    0.2557    0.8596    0.6083    0.0048    0.2889    0.9318    0.5235    0.0047    0.3039    0.9848    0.5258         0;
   0.2918    1.0000    0.5121    0.0023    0.2640    0.8671    0.5922    0.0033    0.3068    0.8949    0.5120    0.0047    0.3033    0.9561    0.5345         0;
    0.2895    1.0000    0.5311    0.0010    0.2721    0.8744    0.5988    0.0017    0.2959    0.9188    0.5324    0.0034    0.2970    0.9308    0.5284         0;   
0.3904    0.8831    0.7692         0    0.3094    1.0000    0.6301    0.0076    0.2757    0.9399    0.7914    0.0068    0.3128    0.9404    0.5423    0.0141;
 0.3388    0.8698    0.7135    0.0063    0.3129    1.0000    0.6280    0.0003    0.2827    0.9442    0.7784         0    0.3097    0.9342    0.5609    0.0071;
 0.3148    0.8740    0.6922    0.0085    0.3039    1.0000    0.6134    0.0023    0.2814    0.9396    0.7393         0    0.2928    0.9348    0.5758    0.0077;
 0.3230    0.8975    0.6602    0.0103    0.3281    1.0000    0.6381         0    0.2942    0.9699    0.7800    0.0004    0.3064    0.9850    0.6006    0.0071;
  0.3070    0.8714    0.6499    0.0124    0.3109    1.0000    0.6155    0.0026    0.2876    0.9622    0.7293         0    0.2831    0.9907    0.6094    0.0077;
   0.3028    0.8856    0.6672    0.0096    0.3022    1.0000    0.6302    0.0026    0.2842    0.9744    0.7304         0    0.2802    0.9940    0.6056    0.0083;
%  0.2799    0.9509    0.7659    0.0006    0.2976    0.9678    0.5610    0.0074    0.2978    0.8908    0.6250    0.0070    0.3330    1.0000    0.6170         0; 

];
% "true" parameters
for j=1:4

prior0 = normalise(rand(Q,1));
transmat0 = mk_stochastic(rand(Q,Q));
obsmat0 = mk_stochastic(rand(Q,O));

%training data
T = 4;
nex = 16;
d(:,:,j)= dhmm_sample(prior0, transmat0, obsmat0, T, nex);
end