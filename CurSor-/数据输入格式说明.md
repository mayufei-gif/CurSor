# 神经网络数据输入格式逆向分析

## 🔍 代码数据流逆向推导

### 1. 最终数据需求（逆向终点）
神经网络需要两个向量：
- **X向量（输入）**：归一化后的特征值
- **Y向量（输出）**：归一化后的目标值

### 2. 原始数据格式要求（逆向起点）

#### 📊 Excel文件格式要求
**文件类型：** `.xlsx` Excel文件
**文件路径：** 任意路径（代码中示例：`F:\数学建模\授课内容\数据创立结果.xlsx`）

#### 📋 数据排列规则

**核心要求：Excel表格必须是二维矩阵，列数为偶数**

```
| 列1(x1) | 列2(y1) | 列3(x2) | 列4(y2) | 列5(x3) | 列6(y3) | ... |
|---------|---------|---------|---------|---------|---------|-----|
| 1.23    | 4.56    | 2.34    | 5.67    | 3.45    | 6.78    | ... |
| 7.89    | 10.12   | 8.90    | 11.23   | 9.01    | 12.34   | ... |
| ...     | ...     | ...     | ...     | ...     | ...     | ... |
```

#### 🎯 数据提取逻辑
```
奇数列 → X数据（特征）
偶数列 → Y数据（目标值）

示例：
- 第1,3,5,7...列 → 合并为X向量
- 第2,4,6,8...列 → 合并为Y向量
```

### 3. 数据格式验证

#### ✅ 有效数据格式示例

**示例1：简单数据集**
```excel
| A列(x) | B列(y) |
|--------|--------|
| 1.0    | 2.0    |
| 2.0    | 4.0    |
| 3.0    | 6.0    |
| 4.0    | 8.0    |
```

**示例2：多组数据集**
```excel
| A列(x1) | B列(y1) | C列(x2) | D列(y2) | E列(x3) | F列(y3) |
|---------|---------|---------|---------|---------|---------|
| 1.0     | 1.5     | 2.0     | 2.5     | 3.0     | 3.5     |
| 2.0     | 2.8     | 3.0     | 3.8     | 4.0     | 4.8     |
| 3.0     | 4.1     | 4.0     | 5.1     | 5.0     | 6.1     |
```

#### ❌ 无效数据格式

**错误1：奇数列**
```excel
| A列(x) | B列(y) | C列(z) |
|--------|--------|--------|
| 1.0    | 2.0    | 3.0    |
```
*问题：3列无法配对*

**错误2：空值或文本**
```excel
| A列(x) | B列(y) |
|--------|--------|
| 1.0    | 文本   |
| 空值   | 2.0    |
```
*问题：包含非数值数据*

### 4. 数据预处理逆向步骤

#### 🔙 步骤1：从归一化数据反推原始数据
```matlab
% 已知归一化数据
x_norm = [0.1, 0.2, 0.3, 0.4];
y_norm = [0.2, 0.4, 0.6, 0.8];

% 反归一化需要：
xmin = min(x原始值);
xmax = max(x原始值);
ymin = min(y原始值);
ymax = max(y原始值);

x原始 = x_norm * (xmax - xmin) + xmin;
y原始 = y_norm * (ymax - ymin) + ymin;
```

#### 🔙 步骤2：从分离数据反推Excel格式
```matlab
% 已知最终数据
X = [x1, x2, x3, ...];
Y = [y1, y2, y3, ...];

% 重构Excel格式
Excel矩阵 = [x1, y1, x2, y2, x3, y3, ...];
```

### 5. 实际数据准备指南

#### 📁 创建Excel文件的步骤：

1. **打开Excel**，创建新工作表
2. **按列排列数据**：
   - 第1列：X1数据
   - 第2列：Y1数据
   - 第3列：X2数据
   - 第4列：Y2数据
   - 以此类推...

3. **确保数据完整性**：
   - 所有单元格必须是数值
   - 不能有空值或文本
   - 列数必须是偶数

#### 📊 数据规模建议
- **最小数据量**：至少10行数据
- **推荐数据量**：100-1000行数据
- **列数限制**：根据内存，建议2-20列（即1-10组x,y数据）

### 6. 验证工具

#### 🔍 快速验证脚本
```matlab
% 验证数据格式
data = readmatrix('your_file.xlsx');
[rows, cols] = size(data);
if mod(cols, 2) ~= 0
    error('列数必须是偶数');
end
if any(isnan(data(:)))
    error('数据包含空值');
end
if ~all(isnumeric(data(:)))
    error('数据必须全是数值');
end
fprintf('数据格式正确：%d行 × %d列\n', rows, cols);
```

### 7. 常见问题解答

**Q1：能否使用CSV格式？**
A：可以，将`readmatrix`改为`readmatrix('file.csv')`

**Q2：数据量很大怎么办？**
A：可以分批处理，或使用`readtable`替代

**Q3：如何处理缺失值？**
A：使用插值或删除缺失值所在行

**Q4：能否使用多工作表？**
A：可以，使用`readmatrix(file, 'Sheet', 'SheetName')`

---

通过以上逆向分析，你现在可以准确地准备符合神经网络要求的数据格式！